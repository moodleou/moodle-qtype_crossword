{"version":3,"file":"crossword.min.js","sources":["../src/crossword.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JavaScript to make crossword question.\n *\n * @module qtype_crossword/crossword\n * @copyright 2022 The Open University\n * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\nimport {CrosswordGrid} from 'qtype_crossword/crossword_grid';\n\n/**\n * Get words from the table.\n *\n * @return {Object} The words object.\n */\nconst getWordsFromTable = function() {\n    const answersEl = document.querySelectorAll('fieldset#id_words .fcontainer .form-group.row');\n    const alphaRegex = /^[a-z]+/;\n    let words = [];\n    let i = 0;\n    let no = 0;\n    let word = {};\n\n    if (!answersEl) {\n        return words;\n    }\n\n    answersEl.forEach(obj => {\n        let inputEl = obj.querySelectorAll('input[type=\"text\"]');\n        let selectEl = obj.querySelectorAll('select');\n\n        if (inputEl.length > 0) {\n            inputEl.forEach(inputEl => {\n                const name = inputEl.name.match(alphaRegex)?.pop();\n                word[name] = inputEl.value.trim();\n            });\n        }\n\n        if (selectEl.length > 0) {\n            selectEl.forEach(selectEl => {\n                const name = selectEl.name.match(alphaRegex)?.pop();\n                word[name] = selectEl.selectedIndex;\n            });\n        }\n        i++;\n        if (i !== 0 && i % 2 === 0) {\n            no++;\n            word.no = no;\n            words.push(word);\n            word = {};\n        }\n    });\n    return words;\n};\n\n/**\n * Handle action attempt crossword.\n *\n * @param {Object} options The crossword settings.\n */\nexport const attempt = (options) => {\n    const crossword = new CrosswordGrid(options);\n    crossword.buildCrossword();\n};\n\n/**\n * Handle action preview crossword.'\n *\n * @param {Object} options The crossword settings.\n */\nexport const preview = (options) => {\n    const element = document.querySelector(options.element);\n    if (element) {\n        element.removeAttribute('disabled');\n        element.addEventListener('click', function(event) {\n            event.preventDefault();\n            const columnEl = document.querySelector('select[name=\"numcolumns\"]');\n            const rowEl = document.querySelector('select[name=\"numrows\"]');\n            const words = getWordsFromTable(options.target);\n            const settings = {...options,\n                words,\n                colsNum: columnEl.options[columnEl.selectedIndex].text,\n                rowsNum: rowEl.options[rowEl.selectedIndex].text\n            };\n            const crossword = new CrosswordGrid(settings);\n            crossword.previewCrossword();\n        });\n    }\n};\n"],"names":["options","CrosswordGrid","buildCrossword","element","document","querySelector","removeAttribute","addEventListener","event","preventDefault","columnEl","rowEl","words","answersEl","querySelectorAll","alphaRegex","i","no","word","forEach","obj","inputEl","selectEl","length","name","match","_inputEl$name$match","pop","value","trim","_selectEl$name$match","selectedIndex","push","getWordsFromTable","target","settings","colsNum","text","rowsNum","previewCrossword"],"mappings":"sOA0EwBA,UACF,IAAIC,8BAAcD,SAC1BE,mCAQUF,gBACdG,QAAUC,SAASC,cAAcL,QAAQG,SAC3CA,UACAA,QAAQG,gBAAgB,YACxBH,QAAQI,iBAAiB,SAAS,SAASC,OACvCA,MAAMC,uBACAC,SAAWN,SAASC,cAAc,6BAClCM,MAAQP,SAASC,cAAc,0BAC/BO,MA/DQ,iBAChBC,UAAYT,SAASU,iBAAiB,iDACtCC,WAAa,cACfH,MAAQ,GACRI,EAAI,EACJC,GAAK,EACLC,KAAO,UAENL,WAILA,UAAUM,SAAQC,UACVC,QAAUD,IAAIN,iBAAiB,sBAC/BQ,SAAWF,IAAIN,iBAAiB,UAEhCO,QAAQE,OAAS,GACjBF,QAAQF,SAAQE,wCACNG,iCAAOH,QAAQG,KAAKC,MAAMV,kDAAnBW,oBAAgCC,MAC7CT,KAAKM,MAAQH,QAAQO,MAAMC,UAI/BP,SAASC,OAAS,GAClBD,SAASH,SAAQG,0CACPE,kCAAOF,SAASE,KAAKC,MAAMV,mDAApBe,qBAAiCH,MAC9CT,KAAKM,MAAQF,SAASS,iBAG9Bf,IACU,IAANA,GAAWA,EAAI,GAAM,IACrBC,KACAC,KAAKD,GAAKA,GACVL,MAAMoB,KAAKd,MACXA,KAAO,OAGRN,OA5BIA,MAsDWqB,CAAkBjC,QAAQkC,QAClCC,SAAW,IAAInC,QACjBY,MAAAA,MACAwB,QAAS1B,SAASV,QAAQU,SAASqB,eAAeM,KAClDC,QAAS3B,MAAMX,QAAQW,MAAMoB,eAAeM,MAE9B,IAAIpC,8BAAckC,UAC1BI"}